# Test configuration for Claude CLI integration
# Usage: docker compose -f docker-compose.yml -f docker-compose.test.yml --profile dev --profile claude up

services:
  # Override proxy to use local build for testing
  proxy:
    build:
      context: ../services/proxy
      dockerfile: ../../docker/proxy/Dockerfile
    image: claude-nexus-proxy:test
    environment:
      # Disable client auth for testing
      ENABLE_CLIENT_AUTH: "false"
      # Use test API key
      CLAUDE_API_KEY: "test-api-key"
      # Disable storage for testing
      STORAGE_ENABLED: "false"
      # Enable debug
      DEBUG: "true"
  
  # Claude CLI configured for testing
  claude-cli:
    environment:
      # Use the same test API key
      CLAUDE_API_KEY: "test-api-key"
    command: ["sleep", "infinity"]  # Keep container running for testing