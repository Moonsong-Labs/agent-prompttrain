{
  "description": "Compact conversation linking - tests branch creation with compact_HHMMSS pattern",
  "type": "compact",
  "expectedLink": true,
  "parent": {
    "request_id": "6d119664-fb7d-4ef9-a535-afd58054dd87",
    "domain": "localhost:3000",
    "conversation_id": "0c2ac5f6-3d4d-4d9d-8f78-e5858b0a0004",
    "branch_id": "branch_1751205501927",
    "current_message_hash": "d47640c789c65a8eef519174cac025a4ea4d9b7ddf36b8ae3dc9b4a22baea779",
    "parent_message_hash": "b73abfa1a9a97b955e64665462be733bbdf4de6e8d03584c8967d10235696e71",
    "system_hash": "86ca577e64c91c151753e53aae8e13566fc917330de56f7fa860f8136a778090",
    "body": {
      "model": "claude-opus-4-20250514",
      "stream": true,
      "system": "You are Claude Code. You are tasked with summarizing conversations.",
      "messages": [
        {
          "role": "user",
          "content": "hi"
        },
        {
          "role": "assistant",
          "content": "Hello! How can I help you today?"
        },
        {
          "role": "user",
          "content": "after reboot"
        },
        {
          "role": "assistant",
          "content": "I see you've rebooted. How can I help you?"
        },
        {
          "role": "user",
          "content": "test message"
        },
        {
          "role": "assistant",
          "content": "Ready to help. What would you like to work on?"
        },
        {
          "role": "user",
          "content": [
            {
              "text": "Please summarize the conversation.",
              "type": "text",
              "cache_control": {
                "type": "ephemeral"
              }
            }
          ]
        }
      ],
      "metadata": {
        "user_id": "claude-1"
      },
      "max_tokens": 20000,
      "temperature": 1
    },
    "response_body": {
      "id": "msg_01HL996EweQWYgk9s42oJgvZ",
      "role": "assistant",
      "type": "message",
      "model": "claude-opus-4-20250514",
      "usage": {
        "input_tokens": 3,
        "service_tier": "standard",
        "output_tokens": 734,
        "cache_read_input_tokens": 0,
        "cache_creation_input_tokens": 2126
      },
      "content": [
        {
          "text": "Summary: User greeted, rebooted, no technical work performed.",
          "type": "text"
        }
      ],
      "stop_reason": "end_turn",
      "stop_sequence": null
    }
  },
  "child": {
    "request_id": "9b6aea94-f5b2-4a07-aa65-f0fd3d6e1b6e",
    "domain": "localhost:3000",
    "body": {
      "model": "claude-opus-4-20250514",
      "stream": true,
      "system": "You are Claude Code, an interactive CLI tool.",
      "messages": [
        {
          "role": "user",
          "content": [
            {
              "text": "This session is being continued from a previous conversation that ran out of context. The conversation is summarized below:\nSummary: User greeted, rebooted, no work performed.",
              "type": "text"
            },
            {
              "text": "ho",
              "type": "text",
              "cache_control": {
                "type": "ephemeral"
              }
            }
          ]
        }
      ],
      "metadata": {
        "user_id": "claude-1"
      },
      "max_tokens": 32000,
      "temperature": 1
    }
  },
  "expectedSummaryContent": "Summary: User greeted, rebooted, no work performed",
  "expectedBranchPattern": "^compact_\\d{6}$"
}
